From b0704b22b2ebe6382b853e377e2daa9753525301 Mon Sep 17 00:00:00 2001
From: Chris Rummel <crummel@microsoft.com>
Date: Wed, 12 Jun 2019 08:07:30 -0500
Subject: [PATCH 3/3] Re-enable GenFacades in source-build.

---
 .../Microsoft.Cci.Extensions.csproj                    |  4 ++--
 .../Microsoft.DotNet.GenFacades.csproj                 | 10 +++-------
 2 files changed, 5 insertions(+), 9 deletions(-)

diff --git a/src/Microsoft.Cci.Extensions/Microsoft.Cci.Extensions.csproj b/src/Microsoft.Cci.Extensions/Microsoft.Cci.Extensions.csproj
index 70eb9f9c..ffd249be 100644
--- a/src/Microsoft.Cci.Extensions/Microsoft.Cci.Extensions.csproj
+++ b/src/Microsoft.Cci.Extensions/Microsoft.Cci.Extensions.csproj
@@ -3,7 +3,7 @@
     <DisableImplicitAssetTargetFallback>true</DisableImplicitAssetTargetFallback>
     <TargetFrameworks>netstandard2.0</TargetFrameworks>
     <AssetTargetFallback>$(PackageTargetFallback)portable-net45+win8;</AssetTargetFallback>
-    <ExcludeFromSourceBuild>true</ExcludeFromSourceBuild>
+    <ExcludeFromSourceBuild>false</ExcludeFromSourceBuild>
     <IsPackable>true</IsPackable>
   </PropertyGroup>
 
@@ -19,4 +19,4 @@
     <PackageReference Include="System.Diagnostics.TraceSource" Version="4.0.0" />
   </ItemGroup>
 
-</Project>
\ No newline at end of file
+</Project>
diff --git a/src/Microsoft.DotNet.GenFacades/Microsoft.DotNet.GenFacades.csproj b/src/Microsoft.DotNet.GenFacades/Microsoft.DotNet.GenFacades.csproj
index 196bc8dd..cf2a22a2 100644
--- a/src/Microsoft.DotNet.GenFacades/Microsoft.DotNet.GenFacades.csproj
+++ b/src/Microsoft.DotNet.GenFacades/Microsoft.DotNet.GenFacades.csproj
@@ -17,7 +17,7 @@
   </ItemGroup>
 
   <!-- Required for compiling Microsoft.DotNet.GenFacades.ILRewriter -->
-  <ItemGroup Condition="'$(DotNetBuildFromSource)' != 'true'">
+  <ItemGroup>
     <PackageReference Include="Microsoft.Cci" Version="$(MicrosoftCciVersion)" />
     <PackageReference Include="Microsoft.DiaSymReader.Converter" Version="$(MicrosoftDiaSymReaderConverterVersion)" />
     <PackageReference Include="Microsoft.DiaSymReader.Native" Version="$(MicrosoftDiaSymReaderNativeVersion)" />
@@ -26,14 +26,10 @@
     <PackageReference Include="System.Reflection.TypeExtensions" Version="4.3.0" />
   </ItemGroup>
 
-  <ItemGroup Condition="'$(DotNetBuildFromSource)' != 'true'">
+  <ItemGroup>
     <ProjectReference Include="..\Microsoft.Cci.Extensions\Microsoft.Cci.Extensions.csproj" />
   </ItemGroup>
 
-  <ItemGroup Condition="'$(DotNetBuildFromSource)' == 'true'">
-    <Compile Remove="ILRewriter\**" />
-  </ItemGroup>
-
   <!-- On Core, these native binaries wind up in the Runtimes folder of this package. For Desktop, we have to manually mark them to get them packed -->
   <ItemGroup Condition="'$(TargetFramework)'=='net472' and '$(DotNetBuildFromSource)' != 'true'">
     <None Include="$(NuGetPackageRoot)\microsoft.diasymreader.native\$(MicrosoftDiaSymReaderNativeVersion)\runtimes\win\native\Microsoft.DiaSymReader.Native.x86.dll">
@@ -49,4 +45,4 @@
 
   <Import Project="$(RepoRoot)eng\BuildTask.targets" />
 
-</Project>
\ No newline at end of file
+</Project>
-- 
2.18.0

