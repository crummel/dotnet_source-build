From 5436f4e33f9ab8366f82e3a51cbe26651c89551a Mon Sep 17 00:00:00 2001
From: dseefeld <dseefeld@microsoft.com>
Date: Thu, 11 Jun 2020 12:15:06 -0400
Subject: [PATCH 08/11] Include netcorapp5.0 versions in libraries nupkgs

Assets for netcoreapp3.0 are not built in source-build because we don't
have references for past netcoreapp versions.  That leaves the packages
built by the libraries build with a placeholder for netcoreapp3.0, which
causes issues with consumption of these packages in dependent repos.
Packages for netcoreapp5.0 are built but not packaged by design.  This
patch includes these assets in the packages built by the libraries
build, only for the source-build build.
---
 src/libraries/Directory.Build.targets | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/libraries/Directory.Build.targets b/src/libraries/Directory.Build.targets
index 728194da1c9..98ee9430888 100644
--- a/src/libraries/Directory.Build.targets
+++ b/src/libraries/Directory.Build.targets
@@ -232,7 +232,8 @@
   </Choose>
   
   <PropertyGroup>
-    <ExcludeFromPackage Condition="'$(TargetFramework)' == '$(NetCoreAppCurrent)' and '$(ExcludeCurrentNetCoreAppFromPackage)' == 'true'">true</ExcludeFromPackage>
+    <ExcludeFromPackage Condition="'$(TargetFramework)' == '$(NetCoreAppCurrent)' and '$(ExcludeCurrentNetCoreAppFromPackage)' == 'true' and
+'$(DotNetBuildFromSource)' != 'true'">true</ExcludeFromPackage>
     <ExcludeFromPackage Condition="'$(TargetFramework)' == '$(NetFrameworkCurrent)' and '$(ExcludeCurrentFullFrameworkFromPackage)' == 'true'">true</ExcludeFromPackage>
   </PropertyGroup>
 
-- 
2.18.0

